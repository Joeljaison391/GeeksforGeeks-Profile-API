<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GeeksforGeeks Profile API Documentation</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  </head>
  <body>
    <div class="container">
      <h1>GeeksforGeeks Profile API Documentation</h1>

      <div class="section">
        <h2>Overview</h2>
        <p>
          This API allows you to fetch the profile details of users on
          GeeksforGeeks. You can retrieve information such as name, username,
          profile picture, rank, scores, institution, and the number of problems
          solved.
        </p>
      </div>

      <div class="section">
        <h2>Authentication</h2>
        <p>No authentication is required to access this API.</p>
      </div>

      <div class="section">
        <h2>API Documentation</h2>
        <div class="endpoint">
          <p>
            <strong>Endpoint:</strong>
            https://gfg-api-5636a15dd742.herokuapp.com/api/profile/<span
              >:username</span
            >
          </p>
          <p><strong>Method:</strong> GET</p>
          <p><strong>Params:</strong> username</p>
          <p><strong>Response:</strong> JSON</p>
          <p>
            <strong>Response Structure:</strong><br />
            name: name<br />
            username: username<br />
            profilePicture: profilePicture<br />
            rank: rank<br />
            monthlyScore: monthlyScore<br />
            overallScore: overallScore<br />
            institution: institution<br />
            solvedProblemsCount: solvedProblemsCount<br />
            solvedProblems: [ {question: question, link: link}, ... ]
          </p>
        </div>
      </div>

      <div class="section">
        <h2>Sample Response</h2>
        <pre class="sample-response">
    {
      "name": "joeljaison394",
      "username": "joeljaison394",
      "institution": "Sahrdaya College of Engineering and Technology (SCET) Thrissur",
      "languages": "Java, C++, Javascript",
      "rank": "3",
      "overallScore": "334",
      "solvedProblemsCount": "97",
      "longestStreak": "28/1028",
      "monthlyScore": "__",
      "totalSubmissions": 0,
      "solvedProblems": [
        {
          "question": "Occurence of an integer in a Linked List",
          "link": "https://www.geeksforgeeks.org/problems/occurence-of-an-integer-in-a-linked-list/0"
        },
        {
          "question": "Finding middle element in a linked list",
          "link": "https://www.geeksforgeeks.org/problems/finding-middle-element-in-a-linked-list/0"
        },
        ...
      ]
    }
          </pre
        >
      </div>

      <div class="section">
        <h2>Test Live</h2>
        <div class="api-section">
          <h3>Get Profile</h3>
          <div class="input-group">
            <label for="username">Username:</label>
            <input
              type="text"
              id="username"
              placeholder="Enter GeeksforGeeks username"
            />
          </div>
          <div class="input-group">
            <button onclick="fetchProfile()">Fetch Profile</button>
          </div>
          <div class="result" id="profileResult"></div>
        </div>

        <div class="api-section">
          <h3>Generate DSA Card</h3>
          <div class="input-group">
            <label for="usernameCard">Username:</label>
            <input
              type="text"
              id="usernameCard"
              placeholder="Enter GeeksforGeeks username"
            />
          </div>
          <div class="input-group">
            <button onclick="generateDSACard()">Generate DSA Card</button>
            <button onclick="copyEmbeddableHTML()">Copy Embeddable HTML</button>
            <button onclick="downloadDSACardAsImage()">Download as Image</button>
          </div>
          <div class="result" id="dsaCardResult"></div>
        </div>
      </div>

      <div class="section">
        <h2>Rate Limits</h2>
        <p>
          This API has a rate limit of 100 requests per 30 minutes per IP
          address. If you exceed this limit, you will receive the following
          message: "Too many requests from this IP, please try again after 15
          minutes".
        </p>
      </div>

      <div class="section">
        <h2>Contact</h2>
        <p>
          If you have any questions or need further assistance, please contact
          us at joeljaison394@gmail.com
        </p>
      </div>
    </div>

    <footer>
      <p>Made with ❤️ by Joel Jaison</p>
      <a
        href="https://github.com/Joeljaison391/GeeksforGeeks-Profile-API"
        target="_blank"
      >
        <img
          src="github.gif"
          alt="GitHub"
          class="github-icon"
          style="border-radius: 100px; height: 40px; width: 40px"
        />
      </a>
    </footer>

    <script>
      async function fetchProfile() {
        const username = document.getElementById("username").value;
        const resultDiv = document.getElementById("profileResult");
        resultDiv.innerHTML = "Loading...";

        try {
          const response = await fetch(`/api/profile/${username}`);
          const data = await response.json();
          console.log(data);
          resultDiv.innerHTML = `<pre >${JSON.stringify(data, null, 2)}</pre>`;
        } catch (error) {
          resultDiv.innerHTML = "Failed to fetch profile data";
        }
      }

      async function generateDSACard() {
        const username = document.getElementById("usernameCard").value;
        const resultDiv = document.getElementById("dsaCardResult");
        resultDiv.innerHTML = "Loading...";

        try {
          const response = await fetch(`/api/profile/${username}`);
          const profileData = await response.json();

          const dsaCardHTML = `
        <div class="outer">
          <div class="card">
            <div class="ray"></div>
            <div class="card-header">
              <img src="${profileData.profilePicture}" alt="Profile Picture" onerror="this.src='https://i.pinimg.com/736x/0d/64/98/0d64989794b1a4c9d89bff571d3d5842.jpg'">
              <h2>${profileData.name}</h2>
            </div>
            <div class="card-details">
              <p class="rank"><strong>Rank:</strong> ${profileData.rank}</p>
              <p><strong>College:</strong> ${profileData.institution}</p>
              <p><strong>Coding Score:</strong> ${profileData.overallScore}</p>
              <p><strong>Total Solved:</strong> ${profileData.solvedProblemsCount}</p>
              <img src="./gfg-logo.png" alt="DSA Card" class="dsaCard">
            </div>
          </div>
        </div>
      `;
          resultDiv.innerHTML = dsaCardHTML;
        } catch (error) {
          resultDiv.innerHTML = "Failed to generate DSA card";
        }
      }

      function copyEmbeddableHTML() {
        const dsaCardResult = document.getElementById("dsaCardResult");
        const dsaCardHTML = dsaCardResult.innerHTML;

        const tempDiv = document.createElement("div");
        tempDiv.innerHTML = dsaCardHTML;
        document.body.appendChild(tempDiv);

        const range = document.createRange();
        range.selectNode(tempDiv);

        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        try {
          document.execCommand("copy");
          alert("DSA Card HTML copied to clipboard!");
        } catch (err) {
          console.error("Failed to copy: ", err);
        }

        document.body.removeChild(tempDiv);
      }

      async function downloadDSACardAsImage() {
    const dsaCardResult = document.getElementById("dsaCardResult");
    if (!dsaCardResult) return;

    try {
        const canvas = await html2canvas(dsaCardResult);
        const image = canvas.toDataURL("image/png");

        // Create a temporary link to trigger the download
        const link = document.createElement("a");
        link.href = image;
        link.download = "dsa-card.png";
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    } catch (error) {
        console.error("Failed to capture the DSA card as an image:", error);
    }
}
    </script>
  </body>
</html>
